<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bible : Malgache-FranÃ§ais</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/responsive.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <header class="app-header">
        <div class="header-main-controls">
            <!-- Bouton pour ouvrir la sÃ©lection des livres -->
            <button id="open-book-selection" class="selection-btn">
                ğŸ“– SÃ©lectionner un livre
            </button>
            
            <!-- Affichage du livre et chapitre actuel avec navigation -->
            <div class="current-selection">
                <div class="navigation-controls">
                    <button id="prev-chapter" class="nav-btn" title="Chapitre prÃ©cÃ©dent">
                        â† PrÃ©cÃ©dent
                    </button>
                    <span id="current-book-display">GenÃ¨se 1</span>
                    <button id="next-chapter" class="nav-btn" title="Chapitre suivant">
                        Suivant â†’
                    </button>
                </div>
            </div>
            
            <!-- Boutons de mode d'affichage -->
            <div class="display-mode-container">
                <span class="mode-label">Affichage:</span>
                <button class="display-mode-btn active" data-mode="both">Les deux</button>
                <button class="display-mode-btn" data-mode="malagasy-only">Malgache</button>
                <button class="display-mode-btn" data-mode="french-only">FranÃ§ais</button>
            </div>
            
            <button id="theme-toggle">ğŸŒ™</button>
            
            <!-- Section d'authentification -->
            <div class="auth-section">
                <div id="auth-buttons" class="auth-buttons">
                    <button id="login-btn" class="auth-btn">Se connecter</button>
                    <button id="signup-btn" class="auth-btn">CrÃ©er un compte</button>
                </div>
                <div id="user-menu" class="user-menu" style="display: none;">
                    <span id="user-email" class="user-email"></span>
                    <button id="my-annotations-btn" class="auth-btn">Mes annotations</button>
                    <button id="show-homily-tool" class="auth-btn">ğŸ“ PrÃ©parer une homÃ©lie</button>
                    <button id="logout-btn" class="auth-btn">DÃ©connexion</button>
                </div>
            </div>
        </div>

        <!-- Barre d'outils fixe -->
        <div class="toolbar-fixed">
            <div class="toolbar-section">
                <span class="toolbar-label">Outils:</span>
                <button class="tool-btn active" data-tool="pointer" title="Pointeur">
                    ğŸ–±ï¸ Pointeur
                </button>
                <button class="tool-btn" data-tool="pencil-blue" title="Surligner en bleu">
                    ğŸ”µ Bleu
                </button>
                <button class="tool-btn" data-tool="pencil-red" title="Surligner en rouge">
                    ğŸ”´ Rouge
                </button>
                <button class="tool-btn" data-tool="pencil-green" title="Surligner en vert">
                    ğŸŸ¢ Vert
                </button>
                <button class="tool-btn" data-tool="comment" title="Ajouter un commentaire">
                    ğŸ’¬ Commentaire
                </button>
            </div>
        </div>
    </header>

    <!-- Modal de sÃ©lection des livres -->
    <div id="book-selection-modal" class="modal">
        <div class="modal-content selection-modal-content">
            <span class="close">&times;</span>
            <h3>SÃ©lectionner un livre</h3>
            
            <div class="testament-filters">
                <button class="testament-filter active" data-testament="all">Tous</button>
                <button class="testament-filter" data-testament="old">Ancien Testament</button>
                <button class="testament-filter" data-testament="new">Nouveau Testament</button>
            </div>
            
            <div class="books-grid" id="books-grid">
                <!-- Les boutons des livres seront gÃ©nÃ©rÃ©s ici -->
            </div>
        </div>
    </div>

    <!-- Modal de sÃ©lection des chapitres -->
    <div id="chapter-selection-modal" class="modal">
        <div class="modal-content selection-modal-content">
            <span class="close">&times;</span>
            <h3 id="chapter-selection-title">SÃ©lectionner un chapitre</h3>
            
            <div class="chapters-grid" id="chapters-grid">
                <!-- Les boutons des chapitres seront gÃ©nÃ©rÃ©s ici -->
            </div>
        </div>
    </div>

    <!-- Modales d'authentification -->
    <div id="auth-modal" class="modal">
        <div class="modal-content auth-modal-content">
            <span class="close">&times;</span>
            <h3 id="auth-modal-title">Connexion</h3>
            
            <form id="auth-form">
                <div class="form-group">
                    <label for="auth-email">Email:</label>
                    <input type="email" id="auth-email" required>
                </div>
                
                <div class="form-group">
                    <label for="auth-password">Mot de passe:</label>
                    <input type="password" id="auth-password" required>
                </div>
                
                <div id="auth-error" class="error-message" style="display: none;"></div>
                
                <div class="modal-actions">
                    <button type="submit" id="auth-submit-btn" class="btn-primary">Se connecter</button>
                    <button type="button" id="auth-switch-btn" class="btn-secondary">CrÃ©er un compte</button>
                </div>
            </form>
            
            <div class="auth-footer">
                <p><small>En crÃ©ant un compte, vous pourrez sauvegarder vos surlignages et commentaires.</small></p>
            </div>
        </div>
    </div>

    <main class="bible-container">
        <div class="bible-column" id="malagasy-column">
            <div class="column-header">
                <h3>Bible Malgache</h3>
            </div>
            <div class="verses-container" id="malagasy-verses"></div>
        </div>

        <div class="bible-column" id="french-column">
            <div class="column-header">
                <h3>Bible FranÃ§aise (LSG)</h3>
            </div>
            <div class="verses-container" id="french-verses"></div>
        </div>
    </main>

    <!-- Modal de commentaire amÃ©liorÃ© -->
    <div id="comment-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Ajouter un commentaire</h3>
            
            <div class="verse-reference-display">
                <strong>Verset:</strong> <span id="current-verse-ref"></span>
            </div>
            
            <textarea id="comment-text" rows="6" placeholder="Tapez votre commentaire ici..."></textarea>
            
            <div class="link-verse-section">
                <h4>Lier Ã  un autre verset</h4>
                <div class="verse-link-inputs">
                    <select id="link-book-select">
                        <option value="">Choisir un livre</option>
                    </select>
                    <select id="link-chapter-select">
                        <option value="">Chapitre</option>
                    </select>
                    <input type="number" id="link-verse-input" placeholder="Verset" min="1">
                    <button type="button" id="add-verse-link">+ Ajouter</button>
                </div>
                <div id="linked-verses-list" class="linked-verses-list"></div>
            </div>
            
            <div class="modal-actions">
                <button id="save-comment" class="btn-primary">Sauvegarder</button>
                <button id="cancel-comment" class="btn-secondary">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal d'affichage des versets liÃ©s -->
    <div id="verse-preview-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="preview-verse-title"></h3>
            <div id="preview-verse-content" class="preview-content"></div>
        </div>
    </div>

    <!-- Modal de gestion des annotations -->
    <div id="annotations-modal" class="modal">
        <div class="modal-content annotations-modal-content">
            <span class="close">&times;</span>
            <h3>Mes annotations</h3>
            
            <div class="annotations-tabs">
                <button class="annotation-tab active" data-tab="highlights">Surlignages</button>
                <button class="annotation-tab" data-tab="comments">Commentaires</button>
            </div>
            
            <div class="annotations-content">
                <!-- Contenu des surlignages -->
                <div id="highlights-tab" class="annotation-tab-content active">
                    <div class="annotations-list" id="highlights-list">
                        <!-- Les surlignages seront chargÃ©s ici -->
                    </div>
                </div>
                
                <!-- Contenu des commentaires -->
                <div id="comments-tab" class="annotation-tab-content">
                    <div class="annotations-list" id="comments-list">
                        <!-- Les commentaires seront chargÃ©s ici -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal d'Ã©dition de commentaire -->
    <div id="edit-comment-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Modifier le commentaire</h3>
            
            <div class="verse-reference-display">
                <strong>Verset:</strong> <span id="edit-verse-ref"></span>
            </div>
            
            <textarea id="edit-comment-text" rows="6" placeholder="Modifiez votre commentaire..."></textarea>
            
            <div class="modal-actions">
                <button id="update-comment" class="btn-primary">Mettre Ã  jour</button>
                <button id="delete-comment" class="btn-danger">Supprimer</button>
                <button id="cancel-edit" class="btn-secondary">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour l'outil d'homÃ©lie -->
    <div id="homily-section" class="modal">
        <div class="modal-content" style="max-width: 95vw; max-height: 95vh; width: 95vw; height: 95vh;">
            <span class="close">&times;</span>
            <div id="homily-generator"></div>
        </div>
    </div>

    <script type="module" src="scripts/app.js"></script>
</body>
</html>